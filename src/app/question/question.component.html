<br>
<router-outlet></router-outlet>
<br>
<div class="mt-lg-4 container">
  <div *ngIf="formCreateQuestionStatus && !formUpdateQuestionStatus">
    <div class="card card-primary">
      <div class="card-header">
        <h3 class="card-title">Tạo mới câu hỏi</h3>
      </div>
      <div *ngIf="failMessage" class="alert alert-danger">
        <p>{{failMessage}}</p>
      </div>
      <form role="form" [formGroup]="questionForm" (ngSubmit)="updateQuestion(questionCurrentId)"
            *ngIf="formCreateQuestionStatus">
        <div class="card-body">
          <div class="form-group row">
            <div class="col-6">
              <label for="typeOfQuestion">Loại câu hỏi:</label>
              <select class="custom-select custom-select-sm" id="typeOfQuestion"
                      (click)="typeOfQuestionForm($event.target.value)"
                      formControlName="typeOfQuestion">
                <option [ngValue]="null" disabled>Chọn loại câu hỏi</option>
                <option *ngFor="let typeOfQuestion of typeOfQuestionList"
                        [value]="typeOfQuestion.id">{{typeOfQuestion.name}}</option>
              </select>
            </div>
            <div class="col-6">
              <label for="category">Danh mục:</label>
              <select class="custom-select custom-select-sm" id="category" formControlName="category">
                <option [ngValue]="null" disabled>Chọn danh mục câu hỏi</option>
                <option *ngFor="let category of categoryList" [value]="category.id">{{category.name}}</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="question">Câu hỏi:</label>
            <ejs-richtexteditor class="form-control" id="question" formControlName="content"></ejs-richtexteditor>
          </div>
          <div *ngIf="typeOfQuestionFlag===1">
            <form role="form" [formGroup]="correctAnswerForm">
              <div class="card-body" *ngFor="let answer of answerList; index as i">
                <div *ngIf="!updateAnswerStatus">
                  <div class="form-group  row">
                    <div class="form-check col-10">
                      <input class="form-check-input" type="radio" formControlName="content"
                             [value]="answer.content">
                      <label class="form-check-label">{{answer.content}}</label>
                    </div>
                    <div class="col-1">
                      <button type="button" class="btn btn-xs btn-primary"
                              style="float: none;margin: 5px;" (click)="updateAnswerForm(answer.id)"><i
                        class="fa fa-edit"></i></button>
                    </div>
                    <div class="col-1">
                      <button type="button" class="btn btn-xs btn-danger"
                              style="float: none;margin: 5px;"
                              (click)="showDeleteAnswerForm(answer.id,deleteAnswerForm)"><span
                        class="fa fa-times"></span></button>
                    </div>
                  </div>
                </div>
                <div *ngIf="updateAnswerStatus">
                  <form role="form" [formGroup]="answerForm">
                    <div class="card-body row">
                      <div class="form-group col-1">
                        <div class="form-check">
                          <input class="form-check-input" type="radio" [attr.disabled]="false">
                          <label class="form-check-label">Radio</label>
                        </div>
                      </div>
                      <div class="form-group col-9">
                        <input type="email" class="form-control" [value]="answer.content"
                               formControlName="content">
                      </div>
                      <div class="col-1">
                        <button type="button" class="btn btn-xs btn-primary"
                                style="float: none;margin: 5px;" (click)="updateAnswer(answer.id)"><i
                          class="fa fa-save"></i></button>
                      </div>
                      <div class="col-1">
                        <button type="button" class="btn btn-xs btn-danger"
                                style="float: none;margin: 5px;" (click)="updateAnswerForm(answer.id)"><span
                          class="fa fa-close"></span></button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </form>
            <form role="form" [formGroup]="answerForm" (ngSubmit)="addAnswer()">
              <div class="card-body">
                <div class="form-group row">
                  <div class="form-check col-1">
                    <input class="form-check-input" type="radio" [attr.disabled]="false">
                  </div>
                  <input type="text" class="form-control col-10" placeholder="câu trả lời" formControlName="content">
                  <div class="col-1">
                    <button class="btn btn-xs btn-primary">
                      <i class="fa fa-plus fa-lg"></i>
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div *ngIf="typeOfQuestionFlag===2">
            <form role="form" [formGroup]=correctAnswerForm>
              <div class="card-body" *ngFor="let answer of answerList">
                <div class="form-group  row">
                  <div class="form-check col-10">
                    <input class="form-check-input" type="checkbox" formControlName="content"
                           [value]="answer.content">
                    <label class="form-check-label">{{answer.content}}</label>
                  </div>
                  <div class="col-1">
                    <button type="button" class="btn btn-xs btn-primary"
                            style="float: none;margin: 5px;" (click)="updateAnswerForm(answer.id)"><i
                      class="fa fa-edit"></i></button>
                  </div>
                  <div class="col-1">
                    <button type="button" class="btn btn-xs btn-danger"
                            style="float: none;margin: 5px;"
                            (click)="showDeleteAnswerForm(answer.id,deleteAnswerForm)"><span
                      class="fa fa-times"></span></button>
                  </div>
                </div>
              </div>
            </form>
            <form role="form" [formGroup]="answerForm" (ngSubmit)="addAnswer()">
              <div class="card-body row">
                <div class="form-group col-1">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" [attr.disabled]="false">
                  </div>
                </div>
                <div class="form-group col-10">
                  <input class="form-control" placeholder="câu trả lời" type="text" formControlName="content">
                </div>
                <div class="col-1">
                  <button class="btn btn-xs btn-primary">
                    <i class="fa fa-plus"></i>
                  </button>
                </div>
              </div>
            </form>
          </div>
          <div class="row">
            <div class="col-6 text-center">
              <button class="btn btn-xs btn-primary" type="submit" (click)="saveQuestionForm()">
                <i class="fa fa-save fa-lg"></i>
              </button>
            </div>
            <div class="col-6 text-center">
              <button class="btn btn-xs btn-danger" type="submit" (click)="closeQuestionForm()">
                <i class="fa fa-times fa-lg"></i>
              </button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
  <div *ngIf="!formCreateQuestionStatus && formUpdateQuestionStatus">
    <div class="card card-primary">
      <div class="card-header">
        <h3 class="card-title">Cập nhật câu hỏi</h3>
      </div>
      <div *ngIf="failMessage" class="alert alert-danger">
        <p>{{failMessage}}</p>
      </div>
      <form role="form" [formGroup]="questionForm" (ngSubmit)="updateQuestion(currentQuestion.id)"
            *ngIf="formUpdateQuestionStatus">
        <div class="card-body">
          <div class="form-group">
            <label for="typeOfQuestion1">Loại câu hỏi:</label>
            <select class="custom-select custom-select-sm" id="typeOfQuestion1"
                    (click)="typeOfQuestionForm($event.target.value)" formControlName="typeOfQuestion">
              <option [ngValue]="null" disabled>Chọn loại câu hỏi</option>
              <option *ngFor="let typeOfQuestion of typeOfQuestionList"
                      [selected]="currentQuestionTypeOfQuestion === typeOfQuestion.name"
                      [value]="typeOfQuestion.id">{{typeOfQuestion.name}}</option>
            </select>
          </div>
          <div class="form-group">
            <label for="category1">Danh mục:</label>
            <select class="custom-select custom-select-sm" id="category1" formControlName="category">
              <option [ngValue]="null" disabled>Chọn danh mục câu hỏi</option>
              <option *ngFor="let category of categoryList" [value]="category.id"
                      [selected]="currentQuestionCategory === category.name">{{category.name}}</option>
            </select>
          </div>
          <div class="form-group">
            <label for="question1">Câu hỏi:</label>
            <ejs-richtexteditor class="form-control" id="question1" formControlName="content"
                                [value]="this.currentQuestionContent"></ejs-richtexteditor>
          </div>
          <div *ngIf="typeOfQuestionFlag===1">
            <form role="form" [formGroup]="correctAnswerForm">
              <div *ngFor="let answer of answerList; index as i">
                <div class="card-body" *ngIf="!updateAnswerStatus">
                  <div class="form-group row">
                    <div class="form-check col-10" *ngFor="let correctAnswer of correctAnswerList">
                      <input class="form-check-input" type="radio" formControlName="content"
                             [value]="answer.content" [checked]="correctAnswer.content === answer.content">
                      <label class="form-check-label">{{answer.content}}</label>
                    </div>
                    <div class="col-1">
                      <button type="button" class="btn btn-xs btn-primary"
                              style="float: none;margin: 5px;" (click)="updateAnswerForm(answer.id)"><i
                        class="fa fa-edit"></i></button>
                    </div>
                    <div class="col-1">
                      <button type="button" class="btn btn-xs btn-danger"
                              style="float: none;margin: 5px;"
                              (click)="showDeleteAnswerForm(answer.id,deleteAnswerForm)"><span
                        class="fa fa-times"></span></button>
                    </div>
                  </div>
                </div>
                <div *ngIf="updateAnswerStatus">
                  <form role="form" [formGroup]="answerForm">
                    <div class="card-body row">
                      <div class="form-group col-1">
                        <div class="form-check">
                          <input class="form-check-input" type="radio" [attr.disabled]="false">
                          <label class="form-check-label">Radio</label>
                        </div>
                      </div>
                      <div class="form-group col-9">
                        <input type="email" class="form-control" [value]="answer.content"
                               formControlName="content">
                      </div>
                      <div class="col-1">
                        <button type="button" class="btn btn-xs btn-primary"
                                style="float: none;margin: 5px;" (click)="updateAnswer(answer.id)"><i
                          class="fa fa-save"></i></button>
                      </div>
                      <div class="col-1">
                        <button type="button" class="btn btn-xs btn-danger"
                                style="float: none;margin: 5px;" (click)="updateAnswerForm(answer.id)"><span
                          class="fa fa-close"></span></button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </form>
            <form role="form" [formGroup]="answerForm" (ngSubmit)="addAnswer()">
              <div class="card-body">
                <div class="form-group row">
                  <div class="form-check col-1">
                    <input class="form-check-input" type="radio" [attr.disabled]="false">
                  </div>
                  <input type="text" class="form-control col-10" placeholder="câu trả lời" formControlName="content">
                  <div class="col-1">
                    <button class="btn btn-xs btn-primary">
                      <i class="fa fa-plus"></i>
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div *ngIf="typeOfQuestionFlag===2">
            <form role="form" [formGroup]=correctAnswerForm>
              <div class="card-body" *ngFor="let answer of answerList">
                <div class="form-group  row">
                  <div class="form-check col-10">
                    <input class="form-check-input" type="checkbox" formControlName="content"
                           [value]="answer.content">
                    <label class="form-check-label">{{answer.content}}</label>
                  </div>
                  <div class="col-1">
                    <button type="button" class="btn btn-xs btn-primary"
                            style="float: none;margin: 5px;" (click)="updateAnswerForm(answer.id)"><i
                      class="fa fa-edit"></i></button>
                  </div>
                  <div class="col-1">
                    <button type="button" class="btn btn-xs btn-danger"
                            style="float: none;margin: 5px;"
                            (click)="showDeleteAnswerForm(answer.id,deleteAnswerForm)"><span
                      class="fa fa-times"></span></button>
                  </div>
                </div>
              </div>
            </form>
            <form role="form" [formGroup]="answerForm" (ngSubmit)="addAnswer()">
              <div class="card-body row">
                <div class="form-group col-1">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" [attr.disabled]="false">
                  </div>
                </div>
                <div class="form-group col-10">
                  <input class="form-control" placeholder="câu trả lời" type="text" formControlName="content">
                </div>
                <div class="col-1">
                  <button class="btn btn-xs btn-primary">
                    <i class="fa fa-plus fa-lg"></i>
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
        <div class="row">
          <div class="col-6 text-center">
            <button class="btn btn-primary waves-effect waves-light" type="submit">
              <i class="fa fa-save fa-lg"></i>
            </button>
          </div>
          <div class="col-6 text-center">
            <button class="btn btn-danger waves-effect waves-light" type="submit"
                    (click)="onClickUpdate(currentQuestion.id)">
              <i class="fa fa-times fa-lg"></i>
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
  <div>
    <ng-template #deleteQuestionForm let-modal>
      <div class="modal-header">
        <h4 class="modal-title">Xóa thông tin câu hỏi</h4>
        <button type="button" class="close" aria-label="Close" (click)="close()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="questionForm" (ngSubmit)="deleteQuestion(currentQuestion.id)">
          <div class="value">
            <div class="input-group">
              <span [innerHTML]="currentQuestionContent"></span>
            </div>
          </div>
          <br>
          <div class="modal-footer">
            <button type="submit" class="tabledit-edit-button btn btn-danger waves-effect waves-light">
              <i class="fa fa-trash fa-lg"></i>
              Xóa
            </button>
          </div>
        </form>
      </div>
    </ng-template>
  </div>
  <div>
    <ng-template #deleteAnswerForm let-modal>
      <div class="modal-header">
        <h4 class="modal-title">Xóa thông tin câu trả lời</h4>
        <button type="button" class="close" aria-label="Close" (click)="close()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="answerForm" (ngSubmit)="deleteAnswer(currentAnswer.id)">
          <div class="value">
            <div class="input-group">
              <span>{{currentAnswerContent}}</span>
            </div>
          </div>
          <br>
          <div class="modal-footer">
            <button type="submit" class="tabledit-edit-button btn btn-danger waves-effect waves-light">
              <i class="fa fa-trash fa-lg"></i>
              Xóa
            </button>
          </div>
        </form>
      </div>
    </ng-template>
  </div>
  <div *ngIf="!formCreateQuestionStatus && !formUpdateQuestionStatus">
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Danh sách câu hỏi</h3>
            <form [formGroup]="searchForm"
                         (ngSubmit)="searchQuestion(searchForm.value.category, searchForm.value.typeOfQuestion, searchForm.value.content)">
            <div class="input-group input-group-sm">
              <input class="form-control mr-3 col-5" type="search" placeholder="Tìm kiếm"
                     aria-label="Search" formControlName="content">
              <select class="form-control mr-3 col-2" formControlName="category">
                <option [value]="null">Danh mục</option>
                <option *ngFor="let category of categoryList"
                        [value]="category.name">{{category.name}}</option>
              </select>
              <select class="form-control mr-3 col-2" formControlName="typeOfQuestion">
                <option [value]="null">Loại câu hỏi</option>
                <option *ngFor="let typeOfQuestion of typeOfQuestionList"
                        [value]="typeOfQuestion.name">{{typeOfQuestion.name}}</option>
              </select>
              <div class="input-group-append col-3">
                <button class="btn btn-primary" type="submit">
                  Tìm kiếm <i class="fa fa-search"></i>
                </button>
              </div>
            </div>
          </form>
            <div class="card-tools">
              <button type="button"
                      class="btn btn-sm btn-primary float-lg-right"
                      *ngIf="!formCreateQuestionStatus" (click)="onClickCreate()">
                <span class="fa fa-plus"></span>
              </button>
            </div>
          </div>
          <div class="card-body table-responsive p-0">
            <table matSort (matSortChange)="sortQuestion($event)" class="table table-head-fixed table-hover"
                   id="example-2">
              <thead>
              <tr>
                <th mat-sort-header="id" style="width: 10px">#</th>
                <th mat-sort-header="content">Nội dung câu hỏi</th>
                <th></th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let question of questionStatusIsTrueList">
                <td>{{question.id}}</td>
                <td [innerHTML]="question.content"></td>
                <td>
                  <div class="float-lg-right" style="float: none;">
                    <button type="button" class="btn btn-xs btn-primary"
                            style="float: none;margin: 5px;" (click)="onClickUpdate(question.id)">
                      <i class="fa fa-edit"></i>
                    </button>
                    <button type="button" class="btn btn-xs btn-danger"
                            style="float: none;margin: 5px;"
                            (click)="showDeleteQuestionForm(question.id, deleteQuestionForm)">
                      <i class="fa fa-trash"></i>
                    </button>
                  </div>
                </td>
              </tr>
              <tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
