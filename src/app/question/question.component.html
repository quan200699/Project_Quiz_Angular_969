<br>
<router-outlet></router-outlet>
<div class="mt-lg-4 container">
  <div *ngIf="formCreateQuestionStatus && !formUpdateQuestionStatus">
    <div class="page-wrapper bg-gra-03 p-t-45 p-b-50">
      <div class="wrapper wrapper--w790">
        <div class="card card-5">
          <div class="card-heading">
            <h2 class="title">Tạo mới câu hỏi</h2>
          </div>
          <div *ngIf="failMessage" class="alert alert-danger">
            <p>{{failMessage}}</p>
          </div>
          <div class="card-body">
            <form [formGroup]="questionForm" (ngSubmit)="updateQuestion(questionCurrentId)"
                  *ngIf="formCreateQuestionStatus">
              <div class="form-row m-b-55">
                <div class="col-6">
                  <div class="name">
                    Loại câu hỏi:
                  </div>
                  <div class="value text-center">
                    <select class="custom-select custom-select-sm" (click)="typeOfQuestionForm($event.target.value)"
                            formControlName="typeOfQuestion">
                      <option [ngValue]="null" disabled>Chọn loại câu hỏi</option>
                      <option *ngFor="let typeOfQuestion of typeOfQuestionList"
                              [value]="typeOfQuestion.id">{{typeOfQuestion.name}}</option>
                    </select>
                  </div>
                </div>
                <div class="col-6">
                  <div class="name">
                    Danh mục:
                  </div>
                  <div class="value text-center">
                    <select class="custom-select custom-select-sm" formControlName="category">
                      <option [ngValue]="null" disabled>Chọn danh mục câu hỏi</option>
                      <option *ngFor="let category of categoryList" [value]="category.id">{{category.name}}</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="form-row m-b-55">
                <div class="name">Câu hỏi:</div>
              </div>
              <div class="form-row m-b-55">
                <ejs-richtexteditor formControlName="content"></ejs-richtexteditor>
              </div>
              <div *ngIf="typeOfQuestionFlag===1">
                <form [formGroup]="correctAnswerForm">
                  <div *ngFor="let answer of answerList; index as i">
                    <div class="form-row m-b-55" *ngIf="!updateAnswerStatus">
                      <div class="name">
                        <label class="radio-container m-r-55">
                          <input type="radio" formControlName="content" [value]="answer.content">
                          <span class="checkmark"></span>
                        </label>
                      </div>
                      <div class="value row">
                        <div class="col-10">
                          <div class="input-group">
                            <span>{{answer.content}}</span>
                          </div>
                        </div>
                        <div class="col-1">
                          <button type="button" class="tabledit-edit-button btn btn-primary waves-effect waves-light"
                                  style="float: none;margin: 5px;" (click)="updateAnswerForm(answer.id)"><i
                            class="fa fa-edit"></i></button>
                        </div>
                        <div class="col-1">
                          <button type="button" class="tabledit-delete-button btn btn-danger waves-effect waves-light"
                                  style="float: none;margin: 5px;"
                                  (click)="showDeleteAnswerForm(answer.id,deleteAnswerForm)"><span
                            class="fa fa-times"></span></button>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="updateAnswerStatus">
                      <form [formGroup]="answerForm" class="form-row m-b-55">
                        <div class="name">
                          <label class="radio-container m-r-55">
                            <input type="radio" [attr.disabled]="false">
                            <span class="checkmark"></span>
                          </label>
                        </div>
                        <div class="value row">
                          <div class="col-10">
                            <div class="input-group">
                              <input type="text" class="input--style-5" [value]="answer.content"
                                     formControlName="content">
                            </div>
                          </div>
                          <div class="col-1">
                            <button type="button" class="tabledit-edit-button btn btn-primary waves-effect waves-light"
                                    style="float: none;margin: 5px;" (click)="updateAnswer(answer.id)"><i
                              class="fa fa-save"></i></button>
                          </div>
                          <div class="col-1">
                            <button type="button" class="tabledit-delete-button btn btn-danger waves-effect waves-light"
                                    style="float: none;margin: 5px;" (click)="updateAnswerForm(answer.id)"><span
                              class="fa fa-close"></span></button>
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>
                </form>
                <div class="form-row m-b-55">
                  <form [formGroup]="answerForm" (ngSubmit)="addAnswer()">
                    <div class="form-row m-b-55">
                      <div class="name col-1">
                        <label class="radio-container m-r-55">
                          <input type="radio" [attr.disabled]="false">
                          <span class="checkmark"></span>
                        </label>
                      </div>
                      <div class="value col-10">
                        <div class="input-group">
                          <input class="input--style-5" placeholder="câu trả lời" type="text" formControlName="content">
                        </div>
                      </div>
                      <div class="col-1">
                        <button class="tabledit-edit-button btn btn-primary waves-effect waves-light">
                          <i class="fa fa-plus fa-lg"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
              <div *ngIf="typeOfQuestionFlag===2">
                <form [formGroup]=correctAnswerForm>
                  <div class="form-row m-b-55" *ngFor="let answer of answerList">
                    <div class="name">
                      <label class="radio-container m-r-55">
                        <input type="radio" formControlName="content" [value]="answer.content">
                        <span class="checkmark"></span>
                      </label>
                    </div>
                    <div class="value row">
                      <div class="col-10">
                        <div class="input-group">
                          <span>{{answer.content}}</span>
                        </div>
                      </div>
                      <div class="col-1">
                        <button type="button" class="tabledit-edit-button btn btn-primary waves-effect waves-light"
                                style="float: none;margin: 5px;" (click)="updateAnswerForm(answer.id)"><i
                          class="fa fa-edit"></i></button>
                      </div>
                      <div class="col-1">
                        <button type="button" class="tabledit-delete-button btn btn-danger waves-effect waves-light"
                                style="float: none;margin: 5px;"
                                (click)="showDeleteAnswerForm(answer.id,deleteAnswerForm)"><span
                          class="fa fa-times"></span></button>
                      </div>
                    </div>
                  </div>
                </form>
                <div class="form-row m-b-55">
                  <form [formGroup]="answerForm" (ngSubmit)="addAnswer()">
                    <div class="form-row m-b-55">
                      <div class="name col-1" *ngIf="typeOfQuestionFlag!==2">
                        <label class="radio-container m-r-55">
                          <input type="radio" [attr.disabled]="false">
                          <span class="checkmark"></span>
                        </label>
                      </div>
                      <div class="name col-1" *ngIf="typeOfQuestionFlag===2">
                        <label class="radio-container m-r-55">
                          <input type="radio" [attr.disabled]="false">
                          <span class="checkmark"></span>
                        </label>
                      </div>
                      <div class="value col-10">
                        <div class="input-group">
                          <input class="input--style-5" placeholder="câu trả lời" type="text" formControlName="content">
                        </div>
                      </div>
                      <div class="col-1">
                        <button class="tabledit-edit-button btn btn-primary waves-effect waves-light">
                          <i class="fa fa-plus fa-lg"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
              <div class="row">
                <div class="col-6 text-center">
                  <button class="btn btn-primary waves-effect waves-light" type="submit" (click)="saveQuestionForm()">
                    <i class="fa fa-save fa-lg"></i>
                  </button>
                </div>
                <div class="col-6 text-center">
                  <button class="btn btn-danger waves-effect waves-light" type="submit" (click)="closeQuestionForm()">
                    <i class="fa fa-times fa-lg"></i>
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="!formCreateQuestionStatus && formUpdateQuestionStatus">
    <div class="page-wrapper bg-gra-03 p-t-45 p-b-50">
      <div class="wrapper wrapper--w790">
        <div class="card card-5">
          <div class="card-heading">
            <h2 class="title">Cập nhật câu hỏi</h2>
          </div>
          <div *ngIf="failMessage" class="alert alert-danger">
            <p>{{failMessage}}</p>
          </div>
          <div class="card-body">
            <form [formGroup]="questionForm" (ngSubmit)="updateQuestion(currentQuestion.id)"
                  *ngIf="formUpdateQuestionStatus">
              <div class="form-row m-b-55">
                <div class="col-6 text-center">
                  <div class="name">
                    Loại câu hỏi:
                  </div>
                  <div class="value">
                    <select class="custom-select custom-select-sm" (click)="typeOfQuestionForm($event.target.value)"
                            formControlName="typeOfQuestion">
                      <option [ngValue]="null" disabled>Chọn loại câu hỏi</option>
                      <option *ngFor="let typeOfQuestion of typeOfQuestionList"
                              [value]="typeOfQuestion.id">{{typeOfQuestion.name}}</option>
                    </select>
                  </div>
                </div>
                <div class="col-6 text-center">
                  <div class="name">
                    Danh mục:
                  </div>
                  <div class="value">
                    <select class="custom-select custom-select-sm" formControlName="category">
                      <option [ngValue]="null" disabled>Chọn danh mục câu hỏi</option>
                      <option *ngFor="let category of categoryList" [ngValue]="category.id">{{category.name}}</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="form-row m-b-55">
                <div class="name">Câu hỏi:</div>
                <div class="value">
                  <div class="input-group">
                    <ejs-richtexteditor formControlName="content"
                                        [value]="this.currentQuestionContent"></ejs-richtexteditor>
                  </div>
                </div>
              </div>
              <div *ngIf="typeOfQuestionFlag==1">
                <form [formGroup]="correctAnswerForm">
                  <div *ngFor="let answer of answerList">
                    <div class="form-row m-b-55" *ngIf="!updateAnswerStatus">
                      <div class="name">
                        <label class="radio-container m-r-55" *ngFor="let correctAnswer of correctAnswerList">
                          <input type="radio" formControlName="content" [value]="answer.content"
                                 [checked]="correctAnswer.content === answer.content">
                          <span class="checkmark"></span>
                        </label>
                      </div>
                      <div class="value row">
                        <div class="col-10">
                          <div class="input-group">
                            <span>{{answer.content}}</span>
                          </div>
                        </div>
                        <div class="col-1">
                          <button type="button" class="tabledit-edit-button btn btn-primary waves-effect waves-light"
                                  style="float: none;margin: 5px;" (click)="updateAnswerForm(answer.id)"><i
                            class="fa fa-edit"></i></button>
                        </div>
                        <div class="col-1">
                          <button type="button" class="tabledit-delete-button btn btn-danger waves-effect waves-light"
                                  style="float: none;margin: 5px;"
                                  (click)="showDeleteAnswerForm(answer.id,deleteAnswerForm)"><span
                            class="fa fa-times"></span></button>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="updateAnswerStatus">
                      <form [formGroup]="answerForm" class="form-row m-b-55">
                        <div class="name">
                          <label class="radio-container m-r-55">
                            <input type="radio" [attr.disabled]="false">
                            <span class="checkmark"></span>
                          </label>
                        </div>
                        <div class="value row">
                          <div class="col-10">
                            <div class="input-group">
                              <input type="text" class="input--style-5" [value]="answer.content"
                                     formControlName="content">
                            </div>
                          </div>
                          <div class="col-1">
                            <button type="button" class="tabledit-edit-button btn btn-primary waves-effect waves-light"
                                    style="float: none;margin: 5px;" (click)="updateAnswer(answer.id)"><i
                              class="fa fa-save"></i></button>
                          </div>
                          <div class="col-1">
                            <button type="button" class="tabledit-delete-button btn btn-danger waves-effect waves-light"
                                    style="float: none;margin: 5px;" (click)="updateAnswerForm(answer.id)"><span
                              class="fa fa-close"></span></button>
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>
                </form>
                <div class="form-row m-b-55">
                  <form [formGroup]="answerForm" (ngSubmit)="addAnswer()">
                    <div class="form-row m-b-55">
                      <div class="name col-1">
                        <label class="radio-container m-r-55">
                          <input type="radio" [attr.disabled]="false">
                          <span class="checkmark"></span>
                        </label>
                      </div>
                      <div class="value col-10">
                        <div class="input-group">
                          <input class="input--style-5" placeholder="câu trả lời" type="text" formControlName="content">
                        </div>
                      </div>
                      <div class="col-1">
                        <button class="tabledit-edit-button btn btn-primary waves-effect waves-light">
                          <i class="fa fa-plus fa-lg"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
              <div *ngIf="typeOfQuestionFlag==2">
                <div class="form-row m-b-55" *ngFor="let answer of answerList">
                  <div class="name">
                    <label class="radio-container m-r-55">
                      <input type="checkbox" [value]="answer.content">
                      <span class="checkmark"></span>
                    </label>
                  </div>
                  <div class="value row">
                    <div class="col-10">
                      <div class="input-group">
                        <span>{{answer.content}}</span>
                      </div>
                    </div>
                    <div class="col-1">
                      <button type="button" class="tabledit-edit-button btn btn-primary waves-effect waves-light"
                              style="float: none;margin: 5px;" (click)="updateAnswerForm(answer.id)"><i
                        class="fa fa-edit"></i></button>
                    </div>
                    <div class="col-1">
                      <button type="button" class="tabledit-delete-button btn btn-danger waves-effect waves-light"
                              style="float: none;margin: 5px;"
                              (click)="showDeleteAnswerForm(answer.id,deleteAnswerForm)"><span
                        class="fa fa-times"></span></button>
                    </div>
                  </div>
                </div>
                <div class="form-row m-b-55">
                  <form [formGroup]="answerForm" (ngSubmit)="addAnswer()">
                    <div class="form-row m-b-55">
                      <div class="name col-1" *ngIf="typeOfQuestionFlag!==2">
                        <label class="radio-container m-r-55">
                          <input type="radio" [attr.disabled]="false">
                          <span class="checkmark"></span>
                        </label>
                      </div>
                      <div class="name col-1" *ngIf="typeOfQuestionFlag===2">
                        <div class="border-checkbox-group border-checkbox-group-success">
                          <input class="border-checkbox" type="checkbox" [attr.disabled]="false">
                        </div>
                      </div>
                      <div class="value col-10">
                        <div class="input-group">
                          <input class="input--style-5" placeholder="câu trả lời" type="text" formControlName="content">
                        </div>
                      </div>
                      <div class="col-1">
                        <button class="tabledit-edit-button btn btn-primary waves-effect waves-light">
                          <i class="fa fa-plus fa-lg"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
              </div>
              <div class="row">
                <div class="col-6 text-center">
                  <button class="btn btn-primary waves-effect waves-light" type="submit">
                    <i class="fa fa-save fa-lg"></i>
                  </button>
                </div>
                <div class="col-6 text-center">
                  <button class="btn btn-danger waves-effect waves-light" type="submit"
                          (click)="onClickUpdate(currentQuestion.id)">
                    <i class="fa fa-times fa-lg"></i>
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div>
    <ng-template #deleteQuestionForm let-modal>
      <div class="modal-header">
        <h4 class="modal-title">Xóa thông tin câu hỏi</h4>
        <button type="button" class="close" aria-label="Close" (click)="close()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="questionForm" (ngSubmit)="deleteQuestion(currentQuestion.id)">
          <div class="value">
            <div class="input-group">
              <span [innerHTML]="currentQuestionContent"></span>
            </div>
          </div>
          <br>
          <div class="modal-footer">
            <button type="submit" class="tabledit-edit-button btn btn-danger waves-effect waves-light">
              <i class="fa fa-trash fa-lg"></i>
              Xóa
            </button>
          </div>
        </form>
      </div>
    </ng-template>
  </div>
  <div>
    <ng-template #deleteAnswerForm let-modal>
      <div class="modal-header">
        <h4 class="modal-title">Xóa thông tin câu trả lời</h4>
        <button type="button" class="close" aria-label="Close" (click)="close()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form [formGroup]="answerForm" (ngSubmit)="deleteAnswer(currentAnswer.id)">
          <div class="value">
            <div class="input-group">
              <span>{{currentAnswerContent}}</span>
            </div>
          </div>
          <br>
          <div class="modal-footer">
            <button type="submit" class="tabledit-edit-button btn btn-danger waves-effect waves-light">
              <i class="fa fa-trash fa-lg"></i>
              Xóa
            </button>
          </div>
        </form>
      </div>
    </ng-template>
  </div>
  <div *ngIf="!formCreateQuestionStatus && !formUpdateQuestionStatus">
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Danh sách câu hỏi</h3>
            <div class="card-tools">
            <form [formGroup]="searchForm" class="card-tools"
                  (ngSubmit)="searchQuestion(searchForm.value.category, searchForm.value.typeOfQuestion, searchForm.value.content)">
              <mat-form-field class="example-full-width row">
                <input type="text" name="table_search" class="form-control float-lg-right" placeholder="Tìm kiếm"
                       matInput [formControl]="content" formControlName="content" [matAutocomplete]="auto">
                <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete" [displayWith]="displayFn">
                  <mat-option *ngFor="let question of filteredQuestions | async" [value]="question">
                    <span [innerHTML]="question.content"></span>
                  </mat-option>
                </mat-autocomplete>
              </mat-form-field>
              <div class="row">
                <div class="form-row m-b-55 col-6">
                  <div class="value text-center col-6">
                    <select class="custom-select custom-select-sm" formControlName="category">
                      <option [value]="null">Danh mục</option>
                      <option *ngFor="let category of categoryList"
                              [value]="category.name">{{category.name}}</option>
                    </select>
                  </div>
                  <div class="value text-center col-6">
                    <select class="custom-select custom-select-sm" formControlName="typeOfQuestion">
                      <option [value]="null">Loại câu hỏi</option>
                      <option *ngFor="let typeOfQuestion of typeOfQuestionList"
                              [value]="typeOfQuestion.name">{{typeOfQuestion.name}}</option>
                    </select>
                  </div>
                </div>
                <div class="input-group-append">
                  <button class="btn btn-primary">
                    <i class="fa fa-search"></i>Tìm kiếm
                  </button>
                </div>
              </div>
            </form>
            <button type="button"
                    class="tabledit-edit-button btn btn-primary btn-sm waves-effect waves-light float-lg-right"
                    *ngIf="!formCreateQuestionStatus" (click)="onClickCreate()">
              <span class="fa fa-plus"></span>
            </button>
          </div>
          <div class="card-body table-responsive p-0" style="height: 300px;">
            <table matSort (matSortChange)="sortQuestion($event)" class="table table-head-fixed"
                   id="example-2">
              <thead>
              <tr>
                <th mat-sort-header="id">#</th>
                <th mat-sort-header="content">Nội dung câu hỏi</th>
                <th></th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let question of questionStatusIsTrueList">
                <th scope="row">{{question.id}}</th>
                <td class="tabledit-view-mode" [innerHTML]="question.content"></td>
                <td style="white-space: nowrap; width: 1%;" class="tabledit-view-mode">
                  <div class="tabledit-toolbar btn-toolbar" style="text-align: left;">
                    <div class="btn-group btn-group-sm" style="float: none;">
                      <button type="button" class="tabledit-edit-button btn btn-primary waves-effect waves-light"
                              style="float: none;margin: 5px;" (click)="onClickUpdate(question.id)"><span
                        class="fa fa-edit"></span></button>
                      <button type="button" class="tabledit-delete-button btn btn-danger waves-effect waves-light"
                              style="float: none;margin: 5px;"
                              (click)="showDeleteQuestionForm(question.id, deleteQuestionForm)"><span
                        class="fa fa-trash"></span></button>
                    </div>
                  </div>
                </td>
              </tr>
              <tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
